library(rjags)
#simulate data from experiment with 10 subjects
n <- 10
sigtrials <- noistrials <- 100
h <- rbinom(n,sigtrials, .8)
f <- rbinom(n,noistrials,.2)
#initialize for JAGS
oneinit <- list(mud=0, mub=0, taud=1, taub=1, d=rep(0,n), b=rep(0,n))
myinits <- list(oneinit)[rep(1,4)]
sdtjh <- jags.model("Lecture11_1_SDThierarch.j",
data = list("epsilon"=0.001,
"h"=h, "f"=f, "n"=n,
"sigtrials" =sigtrials,
"noistrials"=noistrials),
inits=myinits,
n.chains=4)
# burnin
update(sdtjh,n.iter=1000)
# perform MCMC
parameters <- c("d", "b", "taud", "taub", "mud", "mub", "phih", "phif")
mcmcfin<-coda.samples(sdtjh,parameters,5000)
summary(mcmcfin)
mcmcfin
mcmcfin.phih
mcmcfin$phih
allpost(mcmcfin,"phih")
allpost <- function(mcmcfin,pn) {
return (unlist(lapply(mcmcfin,FUN=function(x) c(x[,pn]))))
}
allpost(mcmcfin,"phih")
mcmcfin(,1)
mcmcfin
mcmcfin[1]
mcmcfin[1,1]
mcmcfin[1,3]
mcmcfin[1,10]
mcmcfin[1,30]
allpost <- function(mcmcfin,pn) {
return (unlist(lapply(mcmcfin,FUN=function(x) c(x[,pn]))))
}
allpost(mcmcfin,"phih")
allpost(mcmcfin,"phif")
allpost(mcmcfin,1)
allpost(mcmcfin,"phif[1]")
mean( allpost(mcmcfin,"phif[1]") )
for(i in c(1:10)) {
print( mean( allpost(mcmcfin,"phif[1]") ))
}
for(i in c(1:10)) {
print( mean( allpost(mcmcfin,"phif[i]") ))
}
paste("phif[", 1, "]")
for(i in c(1:10)) {
print( mean( allpost(mcmcfin,paste("phif[", i, "]")) ))
}
paste("phif["i"]")
print( mean( allpost(mcmcfin,"phif[1]") ))
print( mean( allpost(mcmcfin,"phif[2]") ))
print( mean( allpost(mcmcfin,"phif[1]") ))
print( mean( allpost(mcmcfin,"phif[2]") ))
print( mean( allpost(mcmcfin,"phif[3]") ))
print( mean( allpost(mcmcfin,"phif[4]") ))
print( mean( allpost(mcmcfin,"phif[5]") ))
h
f
print( mean( allpost(mcmcfin,"phih[1]") ))
print( mean( allpost(mcmcfin,"phih[2]") ))
print( mean( allpost(mcmcfin,"phih[3]") ))
print( mean( allpost(mcmcfin,"phih[4]") ))
print( mean( allpost(mcmcfin,"phih[5]") ))
print( h(1:5) )
print( h[1:5] )
library(rjags)
epsilon <- .01
#simulate data for 4 subjects
tlags <- c(0, 1, 5, 10, 20, 50)
nlags <- length(tlags)
nsubj <- 4
nitems <- 20
nrecalled <- matrix(0,nsubj,nlags)
for (i in c(1:nsubj)) {
a     <- runif(1,.0,.2)
b     <- runif(1,.9,1.0)
alpha <- runif(1,.1,.4)
print(c(a,b,alpha))
for (j in c(1:nlags)) {
p <- a + (1-a) * b * exp(-alpha*tlags[j])
nrecalled[i,j] <- rbinom(1,nitems,p)
}
}
#define model
forgexpjh <- jags.model("Lecture11_2_hierarchforgexp.j",
data = list("epsilon"=epsilon,
"t"  = tlags,
"k"  = nrecalled,
"n"  = nitems,
"ns" = nsubj,
"nt" = nlags),
n.chains=1)
# burnin
update(forgexpjh,n.iter=1000)
# perform MCMC
parameters <- c("mualpha", "mua", "mub",
"taualpha", "taua", "taub",
"a", "b", "alpha","theta")
mcmcfin<-coda.samples(forgexpjh,parameters,5000)
summary(mcmcfin)
?runif
allpost(mcmcfin, theta)
allpost(mcmcfin, theta[1,])
allpost(mcmcfin, theta[1])
allpost(mcmcfin, theta[1,1])
allpost(mcmcfin, "theta[1]")
allpost(mcmcfin, "theta")
allpost(mcmcfin, "theta[1,1]")
library(rjags)
epsilon <- .01
#simulate data for 4 subjects
tlags <- c(0, 1, 5, 10, 20, 50)
nlags <- length(tlags)
nsubj <- 4
nitems <- 20
nrecalled <- matrix(0,nsubj,nlags)
for (i in c(1:nsubj)) {
a     <- runif(1,.0,.2)
b     <- runif(1,.9,1.0)
beta <- runif(1,.1,.4)
print(c(a,b,beta))
for (j in c(1:nlags)) {
p <- a + (1-a) * b * (tlags[j]+1)^(-beta)
nrecalled[i,j] <- rbinom(1,nitems,p)
}
}
#define model
forgpowjh <- jags.model("Lecture11_3_hierarchforgpow.j",
data = list("epsilon"=epsilon,
"t"  = tlags,
"k"  = nrecalled,
"n"  = nitems,
"ns" = nsubj,
"nt" = nlags),
n.chains=1)
# burnin
update(forgpowjh,n.iter=1000)
# perform MCMC
parameters <- c("mubeta", "mua", "mub",
"taubeta", "taua", "taub",
"a", "b", "beta","theta")
mcmcfin<-coda.samples(forgpowjh,parameters,5000)
summary(mcmcfin)
library(R.utils)
library(rjags)
grabfun<-function(x,p,var) {return(x[x$subj==p,var])}
itcdata<-read.table("Lecture11_4_hierarchicalITC.dat",header=TRUE)
subjects <- unique(itcdata$subj)
ntrials  <- dim(itcdata)[1]/length(unique(itcdata$subj))
nsubj    <- length(unique(itcdata$subj))
delays4A  <- t(vapply(subjects,FUN=function(x) grabfun(itcdata,x,"DA"),integer(ntrials)))
delays4B  <- t(vapply(subjects,FUN=function(x) grabfun(itcdata,x,"DB"),integer(ntrials)))
amounts4A <- t(vapply(subjects,FUN=function(x) grabfun(itcdata,x,"A"),integer(ntrials)))
amounts4B <- t(vapply(subjects,FUN=function(x) grabfun(itcdata,x,"B"),integer(ntrials)))
responses <- t(vapply(subjects,FUN=function(x) grabfun(itcdata,x,"R"),integer(ntrials)))
#initialize model for JAGS
hierITC <- jags.model("Lecture11_4_hierarchicalITC.j",
data = list("nsubj"=nsubj,
"DA"=delays4A,
"DB"=delays4B,
"A"=amounts4A,
"B"=amounts4B,
"T"=ntrials,
"R"=responses),
n.chains=4)
# burnin
update(hierITC,n.iter=1000)
# perform MCMC
parameters <- c("k", "alpha", "groupkmu", "groupksigma", "groupALPHAmu", "groupALPHAsigma",
"VA","VB","P","DB")
mcmcfin<-coda.samples(hierITC,parameters,5000)
summary(mcmcfin)
library(rjags)
#simulate data from experiment with 10 subjects
n <- 10
sigtrials <- noistrials <- 100
h <- rbinom(n,sigtrials, .8)
f <- rbinom(n,noistrials,.2)
#initialize for JAGS
oneinit <- list(mud=0, mub=0, taud=1, taub=1, d=rep(0,n), b=rep(0,n))
myinits <- list(oneinit)[rep(1,4)]
sdtjh <- jags.model("Lecture11_1_SDThierarch.j",
data = list("epsilon"=0.001,
"h"=h, "f"=f, "n"=n,
"sigtrials" =sigtrials,
"noistrials"=noistrials),
inits=myinits,
n.chains=4)
# burnin
update(sdtjh,n.iter=1000)
# perform MCMC
parameters <- c("d", "b", "taud", "taub", "mud", "mub", "phih", "phif")
mcmcfin<-coda.samples(sdtjh, parameters, 5000)
summary(mcmcfin)
# plot(mcmcfin)
#Listing 8.10 from here on
allpost <- function(mcmcfin,pn) {
return (unlist(lapply(mcmcfin,FUN=function(x) c(x[,pn]))))
}
print( mean( allpost(mcmcfin,"phih[1]") ))  # predicted from HSDT
print( mean( allpost(mcmcfin,"phih[2]") ))
print( mean( allpost(mcmcfin,"phih[3]") ))
print( mean( allpost(mcmcfin,"phih[4]") ))
print( mean( allpost(mcmcfin,"phih[5]") ))
print( h[1:5] )   # observed data
print( mean( allpost(mcmcfin,"phif[1]") ))  # predicted from HSDT
print( mean( allpost(mcmcfin,"phif[2]") ))
print( mean( allpost(mcmcfin,"phif[3]") ))
print( mean( allpost(mcmcfin,"phif[4]") ))
print( mean( allpost(mcmcfin,"phif[5]") ))
print( f[1:5] )   # observed data
library(rjags)
epsilon <- .01
#simulate data for 4 subjects
tlags <- c(0, 1, 5, 10, 20, 50)
nlags <- length(tlags)
nsubj <- 4
nitems <- 20
nrecalled <- matrix(0,nsubj,nlags)
for (i in c(1:nsubj)) {
a     <- runif(1, 0.0, 0.2)  # generate 1 sample from uniform distribution
b     <- runif(1, 0.9, 1.0)
alpha <- runif(1, 0.1, 0.4)
print(c(a,b,alpha))
for (j in c(1:nlags)) {
p <- a + (1-a) * b * exp(-alpha*tlags[j])
nrecalled[i,j] <- rbinom(1,nitems,p)
}
}
#define model
forgexpjh <- jags.model("Lecture11_2_hierarchforgexp.j",
data = list("epsilon"=epsilon,
"t"  = tlags,
"k"  = nrecalled,
"n"  = nitems,
"ns" = nsubj,
"nt" = nlags),
n.chains=1)
# burnin
update(forgexpjh,n.iter=1000)
# perform MCMC
parameters <- c("mualpha", "mua", "mub",
"taualpha", "taua", "taub",
"a", "b", "alpha","theta")
mcmcfin<-coda.samples(forgexpjh,parameters,5000)
summary(mcmcfin)
library(R.utils)
library(rjags)
grabfun<-function(x,p,var) {return(x[x$subj==p,var])}
itcdata<-read.table("Lecture11_4_hierarchicalITC.dat",header=TRUE)
subjects <- unique(itcdata$subj)
ntrials  <- dim(itcdata)[1]/length(unique(itcdata$subj))
nsubj    <- length(unique(itcdata$subj))
delays4A  <- t(vapply(subjects,FUN=function(x) grabfun(itcdata,x,"DA"),integer(ntrials)))
delays4B  <- t(vapply(subjects,FUN=function(x) grabfun(itcdata,x,"DB"),integer(ntrials)))
amounts4A <- t(vapply(subjects,FUN=function(x) grabfun(itcdata,x,"A"),integer(ntrials)))
amounts4B <- t(vapply(subjects,FUN=function(x) grabfun(itcdata,x,"B"),integer(ntrials)))
responses <- t(vapply(subjects,FUN=function(x) grabfun(itcdata,x,"R"),integer(ntrials)))
#initialize model for JAGS
hierITC <- jags.model("Lecture11_4_hierarchicalITC.j",
data = list("nsubj"=nsubj,
"DA"=delays4A,
"DB"=delays4B,
"A"=amounts4A,
"B"=amounts4B,
"T"=ntrials,
"R"=responses),
n.chains=4)
# burnin
update(hierITC,n.iter=1000)
# perform MCMC
parameters <- c("k", "alpha", "groupkmu", "groupksigma", "groupALPHAmu", "groupALPHAsigma",
"VA","VB","P","DB")
mcmcfin<-coda.samples(hierITC,parameters,5000)
summary(mcmcfin)
allpost <- function(mcmcfin,pn) {
return (unlist(lapply(mcmcfin,FUN=function(x) c(x[,pn]))))
}
print( mean( allpost(mcmcfin,"P[1]") ))
print( mean( allpost(mcmcfin,"P[1,1]") ))
print( mean( allpost(mcmcfin,"P[1,2]") ))
print( mean( allpost(mcmcfin,"P[1,3]") ))
print( mean( allpost(mcmcfin,"k[1]") ))
print( mean( allpost(mcmcfin,"k[2]") ))
print( mean( allpost(mcmcfin,"k[3]") ))
library(rjags)
#simulate data from experiment with 10 subjects
n <- 10
sigtrials <- noistrials <- 100
h <- rbinom(n,sigtrials, .8)
f <- rbinom(n,noistrials,.2)
#initialize for JAGS
oneinit <- list(mud=0, mub=0, taud=1, taub=1, d=rep(0,n), b=rep(0,n))
myinits <- list(oneinit)[rep(1,4)]
sdtjh <- jags.model("Lecture14_1_SDThierarch.j",
data = list("epsilon"=0.001,
"h"=h, "f"=f, "n"=n,
"sigtrials" =sigtrials,
"noistrials"=noistrials),
inits=myinits,
n.chains=4)
# burnin
update(sdtjh,n.iter=1000)
# perform MCMC
parameters <- c("d", "b", "taud", "taub", "mud", "mub", "phih", "phif")
mcmcfin<-coda.samples(sdtjh, parameters, 5000)
summary(mcmcfin)
# plot(mcmcfin)
#Listing 8.10 from here on
allpost <- function(mcmcfin,pn) {
return (unlist(lapply(mcmcfin,FUN=function(x) c(x[,pn]))))
}
print( mean( allpost(mcmcfin,"phih[1]") ))  # predicted from HSDT
print( mean( allpost(mcmcfin,"phih[2]") ))
print( mean( allpost(mcmcfin,"phih[3]") ))
print( mean( allpost(mcmcfin,"phih[4]") ))
print( mean( allpost(mcmcfin,"phih[5]") ))
print( h[1:5] )   # observed data
print( mean( allpost(mcmcfin,"phif[1]") ))  # predicted from HSDT
print( mean( allpost(mcmcfin,"phif[2]") ))
print( mean( allpost(mcmcfin,"phif[3]") ))
print( mean( allpost(mcmcfin,"phif[4]") ))
print( mean( allpost(mcmcfin,"phif[5]") ))
print( f[1:5] )   # observed data
library(rjags)
epsilon <- .01
#simulate data for 4 subjects
tlags <- c(0, 1, 5, 10, 20, 50)
nlags <- length(tlags)
nsubj <- 4
nitems <- 20
nrecalled <- matrix(0,nsubj,nlags)
for (i in c(1:nsubj)) {
a     <- runif(1, 0.0, 0.2)  # generate 1 sample from uniform distribution
b     <- runif(1, 0.9, 1.0)
alpha <- runif(1, 0.1, 0.4)
print(c(a,b,alpha))
for (j in c(1:nlags)) {
p <- a + (1-a) * b * exp(-alpha*tlags[j])
nrecalled[i,j] <- rbinom(1,nitems,p)
}
}
#define model
forgexpjh <- jags.model("Lecture14_2_hierarchforgexp.j",
data = list("epsilon"=epsilon,
"t"  = tlags,
"k"  = nrecalled,
"n"  = nitems,
"ns" = nsubj,
"nt" = nlags),
n.chains=1)
# burnin
update(forgexpjh,n.iter=1000)
# perform MCMC
parameters <- c("mualpha", "mua", "mub",
"taualpha", "taua", "taub",
"a", "b", "alpha","theta")
mcmcfin<-coda.samples(forgexpjh,parameters,5000)
summary(mcmcfin)
library(rjags)
epsilon <- .01
#simulate data for 4 subjects
tlags <- c(0, 1, 5, 10, 20, 50)
nlags <- length(tlags)
nsubj <- 4
nitems <- 20
nrecalled <- matrix(0,nsubj,nlags)
for (i in c(1:nsubj)) {
a     <- runif(1,.0,.2)
b     <- runif(1,.9,1.0)
beta <- runif(1,.1,.4)
print(c(a,b,beta))
for (j in c(1:nlags)) {
p <- a + (1-a) * b * (tlags[j]+1)^(-beta)
nrecalled[i,j] <- rbinom(1,nitems,p)
}
}
#define model
forgpowjh <- jags.model("Lecture14_3_hierarchforgpow.j",
data = list("epsilon"=epsilon,
"t"  = tlags,
"k"  = nrecalled,
"n"  = nitems,
"ns" = nsubj,
"nt" = nlags),
n.chains=1)
# burnin
update(forgpowjh,n.iter=1000)
# perform MCMC
parameters <- c("mubeta", "mua", "mub",
"taubeta", "taua", "taub",
"a", "b", "beta","theta")
mcmcfin<-coda.samples(forgpowjh,parameters,5000)
summary(mcmcfin)
library(R.utils)
library(rjags)
grabfun<-function(x,p,var) {return(x[x$subj==p,var])}
itcdata<-read.table("Lecture11_4_hierarchicalITC.dat",header=TRUE)
subjects <- unique(itcdata$subj)
ntrials  <- dim(itcdata)[1]/length(unique(itcdata$subj))
nsubj    <- length(unique(itcdata$subj))
delays4A  <- t(vapply(subjects,FUN=function(x) grabfun(itcdata,x,"DA"),integer(ntrials)))
delays4B  <- t(vapply(subjects,FUN=function(x) grabfun(itcdata,x,"DB"),integer(ntrials)))
amounts4A <- t(vapply(subjects,FUN=function(x) grabfun(itcdata,x,"A"),integer(ntrials)))
amounts4B <- t(vapply(subjects,FUN=function(x) grabfun(itcdata,x,"B"),integer(ntrials)))
responses <- t(vapply(subjects,FUN=function(x) grabfun(itcdata,x,"R"),integer(ntrials)))
#initialize model for JAGS
hierITC <- jags.model("Lecture14_4_hierarchicalITC.j",
data = list("nsubj"=nsubj,
"DA"=delays4A,
"DB"=delays4B,
"A"=amounts4A,
"B"=amounts4B,
"T"=ntrials,
"R"=responses),
n.chains=4)
# burnin
update(hierITC,n.iter=1000)
# perform MCMC
parameters <- c("k", "alpha", "groupkmu", "groupksigma", "groupALPHAmu", "groupALPHAsigma",
"VA","VB","P","DB")
mcmcfin<-coda.samples(hierITC,parameters,5000)
summary(mcmcfin)
plot(mcmcfin)
plot(mcmcfin)
library(rjags)
#simulate data from experiment with 10 subjects
n <- 10
sigtrials <- noistrials <- 100
h <- rbinom(n,sigtrials, .8)
f <- rbinom(n,noistrials,.2)
#initialize for JAGS
oneinit <- list(mud=0, mub=0, taud=1, taub=1, d=rep(0,n), b=rep(0,n))
myinits <- list(oneinit)[rep(1,4)]
sdtjh <- jags.model("Lecture14_1_SDThierarch.j",
data = list("epsilon"=0.001,
"h"=h, "f"=f, "n"=n,
"sigtrials" =sigtrials,
"noistrials"=noistrials),
inits=myinits,
n.chains=4)
# burnin
update(sdtjh,n.iter=1000)
# perform MCMC
parameters <- c("d", "b", "taud", "taub", "mud", "mub", "phih", "phif")
mcmcfin<-coda.samples(sdtjh, parameters, 5000)
summary(mcmcfin)
plot(mcmcfin)
plot(mcmcfin)
